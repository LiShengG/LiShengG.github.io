(window.webpackJsonp=window.webpackJsonp||[]).push([[25],{377:function(s,t,n){"use strict";n.r(t);var a=n(4),e=Object(a.a)({},(function(){var s=this,t=s._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h3",{attrs:{id:"_1-defer-的基本概念"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-defer-的基本概念"}},[s._v("#")]),s._v(" 1. "),t("strong",[t("code",[s._v("defer")]),s._v(" 的基本概念")])]),s._v(" "),t("ul",[t("li",[t("strong",[s._v("问题")]),s._v(": 请解释 Go 语言中的 "),t("code",[s._v("defer")]),s._v(" 语句，以及它的执行时机。")]),s._v(" "),t("li",[t("strong",[s._v("回答要点")]),s._v(":\n"),t("ul",[t("li",[t("code",[s._v("defer")]),s._v(" 语句用于延迟函数的执行，直到所在函数即将返回时才执行。")]),s._v(" "),t("li",[t("code",[s._v("defer")]),s._v(" 语句的典型应用场景包括：资源清理（如文件关闭、解锁）、日志记录、异常处理等。")]),s._v(" "),t("li",[s._v("多个 "),t("code",[s._v("defer")]),s._v(" 语句按逆序（LIFO，后进先出）执行。")])])])]),s._v(" "),t("h3",{attrs:{id:"_2-defer-的参数求值"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-defer-的参数求值"}},[s._v("#")]),s._v(" 2. "),t("strong",[t("code",[s._v("defer")]),s._v(" 的参数求值")])]),s._v(" "),t("ul",[t("li",[t("strong",[s._v("问题")]),s._v(": 请解释在 "),t("code",[s._v("defer")]),s._v(" 中，函数参数何时求值？给出示例。")]),s._v(" "),t("li",[t("strong",[s._v("回答要点")]),s._v(":\n"),t("ul",[t("li",[t("code",[s._v("defer")]),s._v(" 语句的参数在 "),t("code",[s._v("defer")]),s._v(" 语句执行时就立即求值，而不是在延迟的函数调用时求值。")]),s._v(" "),t("li",[s._v("示例："),t("div",{staticClass:"language-go line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-go"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("func")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("main")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    x "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("defer")]),s._v(" fmt"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("Println")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("x"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 这里的 x 的值是 5")]),s._v("\n    x "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v("\n    fmt"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("Println")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"x ="')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" x"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 输出：")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// x = 10")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 5")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br")])])])])])]),s._v(" "),t("h3",{attrs:{id:"_3-defer-与命名返回值"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-defer-与命名返回值"}},[s._v("#")]),s._v(" 3. "),t("strong",[t("code",[s._v("defer")]),s._v(" 与命名返回值")])]),s._v(" "),t("ul",[t("li",[t("strong",[s._v("问题")]),s._v(": 请解释 "),t("code",[s._v("defer")]),s._v(" 与命名返回值的关系，特别是在 "),t("code",[s._v("defer")]),s._v(" 语句中修改返回值的情况。")]),s._v(" "),t("li",[t("strong",[s._v("回答要点")]),s._v(":\n"),t("ul",[t("li",[s._v("在 Go 中，带有命名返回值的函数会将返回值作为局部变量声明，并在 "),t("code",[s._v("return")]),s._v(" 之前赋值。")]),s._v(" "),t("li",[t("code",[s._v("defer")]),s._v(" 语句可以修改命名返回值。")]),s._v(" "),t("li",[s._v("示例："),t("div",{staticClass:"language-go line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-go"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("func")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("test")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("x "),t("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("int")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("defer")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("func")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" x"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("++")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 输出：2")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])])]),s._v(" "),t("li",[s._v("在这个例子中，"),t("code",[s._v("x")]),s._v(" 是命名返回值，"),t("code",[s._v("return 1")]),s._v(" 会将 "),t("code",[s._v("x")]),s._v(" 设置为 1，然后执行 "),t("code",[s._v("defer")]),s._v(" 中的匿名函数，使 "),t("code",[s._v("x")]),s._v(" 增加 1。")])])])]),s._v(" "),t("h3",{attrs:{id:"_4-多个-defer-的执行顺序"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-多个-defer-的执行顺序"}},[s._v("#")]),s._v(" 4. "),t("strong",[s._v("多个 "),t("code",[s._v("defer")]),s._v(" 的执行顺序")])]),s._v(" "),t("ul",[t("li",[t("strong",[s._v("问题")]),s._v(": 当函数中有多个 "),t("code",[s._v("defer")]),s._v(" 语句时，它们的执行顺序是什么？给出示例。")]),s._v(" "),t("li",[t("strong",[s._v("回答要点")]),s._v(":\n"),t("ul",[t("li",[s._v("多个 "),t("code",[s._v("defer")]),s._v(" 语句按逆序执行，即最后一个 "),t("code",[s._v("defer")]),s._v(" 语句最先执行，第一个 "),t("code",[s._v("defer")]),s._v(" 语句最后执行。")]),s._v(" "),t("li",[s._v("示例："),t("div",{staticClass:"language-go line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-go"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("func")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("main")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("defer")]),s._v(" fmt"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("Println")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"First"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("defer")]),s._v(" fmt"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("Println")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Second"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("defer")]),s._v(" fmt"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("Println")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Third"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 输出：")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// Third")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// Second")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// First")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br")])])])])])]),s._v(" "),t("h3",{attrs:{id:"_5-defer-与-panic-和-recover"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-defer-与-panic-和-recover"}},[s._v("#")]),s._v(" 5. "),t("strong",[t("code",[s._v("defer")]),s._v(" 与 "),t("code",[s._v("panic")]),s._v(" 和 "),t("code",[s._v("recover")])])]),s._v(" "),t("ul",[t("li",[t("strong",[s._v("问题")]),s._v(": "),t("code",[s._v("defer")]),s._v(" 在遇到 "),t("code",[s._v("panic")]),s._v(" 时的行为是什么？如何结合 "),t("code",[s._v("defer")]),s._v(" 和 "),t("code",[s._v("recover")]),s._v(" 来处理异常？")]),s._v(" "),t("li",[t("strong",[s._v("回答要点")]),s._v(":\n"),t("ul",[t("li",[s._v("即使发生 "),t("code",[s._v("panic")]),s._v("，"),t("code",[s._v("defer")]),s._v(" 语句仍然会执行，这是处理异常的最后机会。")]),s._v(" "),t("li",[t("code",[s._v("recover")]),s._v(" 函数可以从 "),t("code",[s._v("panic")]),s._v(" 中恢复，避免程序崩溃。")]),s._v(" "),t("li",[s._v("示例："),t("div",{staticClass:"language-go line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-go"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("func")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("main")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("defer")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("func")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" r "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("recover")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" r "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("nil")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            fmt"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("Println")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Recovered from"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" r"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("panic")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"something went wrong"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 输出：")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// Recovered from something went wrong")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br")])])])])])]),s._v(" "),t("h3",{attrs:{id:"_6-defer-的常见陷阱"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_6-defer-的常见陷阱"}},[s._v("#")]),s._v(" 6. "),t("strong",[t("code",[s._v("defer")]),s._v(" 的常见陷阱")])]),s._v(" "),t("ul",[t("li",[t("strong",[s._v("问题")]),s._v(": 请解释 "),t("code",[s._v("defer")]),s._v(" 使用中的常见陷阱，如闭包捕获变量、循环中的 "),t("code",[s._v("defer")]),s._v(" 等。")]),s._v(" "),t("li",[t("strong",[s._v("回答要点")]),s._v(":\n"),t("ul",[t("li",[t("strong",[s._v("闭包捕获变量")]),s._v("："),t("code",[s._v("defer")]),s._v(" 中的函数如果是闭包，会捕获外部变量的引用，而不是值。")]),s._v(" "),t("li",[t("strong",[s._v("循环中的 "),t("code",[s._v("defer")])]),s._v("："),t("code",[s._v("defer")]),s._v(" 在循环中定义时，会在函数返回时一次性执行，而不是每次循环迭代时立即执行。")]),s._v(" "),t("li",[s._v("示例："),t("div",{staticClass:"language-go line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-go"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("func")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("main")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" i "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" i "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" i"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("++")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("defer")]),s._v(" fmt"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("Println")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("i"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 输出 2 2 2，而不是 0 1 2")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])])])])])]),s._v(" "),t("h3",{attrs:{id:"_7-defer-与性能"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_7-defer-与性能"}},[s._v("#")]),s._v(" 7. "),t("strong",[t("code",[s._v("defer")]),s._v(" 与性能")])]),s._v(" "),t("ul",[t("li",[t("strong",[s._v("问题")]),s._v(": "),t("code",[s._v("defer")]),s._v(" 对性能有何影响？在什么情况下应避免使用 "),t("code",[s._v("defer")]),s._v("？")]),s._v(" "),t("li",[t("strong",[s._v("回答要点")]),s._v(":\n"),t("ul",[t("li",[t("code",[s._v("defer")]),s._v(" 会增加一定的性能开销，因为它需要记录延迟函数调用并在函数返回时执行。")]),s._v(" "),t("li",[s._v("在性能关键的代码路径中，特别是高频调用的情况下，应谨慎使用 "),t("code",[s._v("defer")]),s._v("。")]),s._v(" "),t("li",[s._v("例如，在一个小函数中频繁使用 "),t("code",[s._v("defer")]),s._v(" 关闭文件或释放锁可能导致性能下降。")])])])]),s._v(" "),t("h3",{attrs:{id:"_8-defer-与接口方法"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_8-defer-与接口方法"}},[s._v("#")]),s._v(" 8. "),t("strong",[t("code",[s._v("defer")]),s._v(" 与接口方法")])]),s._v(" "),t("ul",[t("li",[t("strong",[s._v("问题")]),s._v(": 当 "),t("code",[s._v("defer")]),s._v(" 调用接口方法时，有什么特别的注意事项？")]),s._v(" "),t("li",[t("strong",[s._v("回答要点")]),s._v(":\n"),t("ul",[t("li",[t("code",[s._v("defer")]),s._v(" 执行时，接口的动态类型已经固定，因此接口方法调用也会按照定义时的类型执行。")]),s._v(" "),t("li",[s._v("如果接口变量在 "),t("code",[s._v("defer")]),s._v(" 语句之后被修改，那么 "),t("code",[s._v("defer")]),s._v(" 执行的仍然是之前的接口方法。")]),s._v(" "),t("li",[s._v("示例："),t("div",{staticClass:"language-go line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-go"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("type")]),s._v(" MyInterface "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("interface")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("Method")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("type")]),s._v(" MyStruct "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("struct")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("func")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("m "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("MyStruct"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("Method")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    fmt"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("Println")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Method called"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("func")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("main")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("var")]),s._v(" i MyInterface "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("MyStruct"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("defer")]),s._v(" i"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("Method")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    i "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("nil")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 修改接口变量")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 输出：Method called")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br")])])])])])]),s._v(" "),t("h3",{attrs:{id:"_9-defer-在高并发环境下的使用"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_9-defer-在高并发环境下的使用"}},[s._v("#")]),s._v(" 9. "),t("strong",[t("code",[s._v("defer")]),s._v(" 在高并发环境下的使用")])]),s._v(" "),t("ul",[t("li",[t("strong",[s._v("问题")]),s._v(": 在高并发场景下，如何正确使用 "),t("code",[s._v("defer")]),s._v(" 来确保资源的安全释放？")]),s._v(" "),t("li",[t("strong",[s._v("回答要点")]),s._v(":\n"),t("ul",[t("li",[s._v("确保 "),t("code",[s._v("defer")]),s._v(" 所使用的资源在 Goroutine 内部是独立的，不会被其他 Goroutine 竞争访问。")]),s._v(" "),t("li",[s._v("对于需要锁定的资源，使用 "),t("code",[s._v("sync.Mutex")]),s._v(" 和 "),t("code",[s._v("defer")]),s._v(" 来保证锁的正确释放："),t("div",{staticClass:"language-go line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-go"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("var")]),s._v(" mu sync"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Mutex\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("func")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("criticalSection")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    mu"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("Lock")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("defer")]),s._v(" mu"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("Unlock")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// critical code")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br")])])]),s._v(" "),t("li",[s._v("在并发环境下，正确使用 "),t("code",[s._v("defer")]),s._v(" 可以避免因忘记释放资源而引发的死锁或资源泄漏问题。")])])])]),s._v(" "),t("h3",{attrs:{id:"_10-defer-的最佳实践"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_10-defer-的最佳实践"}},[s._v("#")]),s._v(" 10. "),t("strong",[t("code",[s._v("defer")]),s._v(" 的最佳实践")])]),s._v(" "),t("ul",[t("li",[t("strong",[s._v("问题")]),s._v(": 请总结使用 "),t("code",[s._v("defer")]),s._v(" 的最佳实践。")]),s._v(" "),t("li",[t("strong",[s._v("回答要点")]),s._v(":\n"),t("ul",[t("li",[s._v("使用 "),t("code",[s._v("defer")]),s._v(" 来确保资源（如文件、网络连接等）的正确关闭。")]),s._v(" "),t("li",[s._v("在函数开头使用 "),t("code",[s._v("defer")]),s._v(" 声明清理操作，避免中途返回忘记清理。")]),s._v(" "),t("li",[s._v("注意 "),t("code",[s._v("defer")]),s._v(" 的参数求值时机，确保传递的是预期的值。")]),s._v(" "),t("li",[s._v("在高性能场景下慎用 "),t("code",[s._v("defer")]),s._v("，可以手动调用清理函数以优化性能。")])])])])])}),[],!1,null,null,null);t.default=e.exports}}]);